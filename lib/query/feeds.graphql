query AllFeeds($cursor: Cursor) {
  allSubscribedFeeds(first: 20, after: $cursor)
    @connection(key: "allSubscribedFeeds") {
    nodes {
      ...allFeedSubscriptionsFields
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment allFeedSubscriptionsFields on SubscribedFeed {
  id
  feed {
    id
    url
    title
    homePageURL
    micropubEndpoint
    refreshedAt
  }
  autopost
}

mutation AddFeed($input: AddFeedInput!) {
  addFeed(input: $input) {
    feed {
      ...allFeedSubscriptionsFields
    }
  }
}

mutation RefreshFeed($input: RefreshFeedInput!) {
  refreshFeed(input: $input) {
    feed {
      id
      title
      homePageURL
      refreshedAt
    }
  }
}

mutation SetFeedOptions($input: SetFeedOptionsInput!) {
  setFeedOptions(input: $input) {
    feed {
      id
      autopost
    }
  }
}

mutation DeleteFeed($input: DeleteFeedInput!) {
  deleteFeed(input: $input) {
    id
  }
}

query GetFeedDetails($id: ID!) {
  subscribedFeed(id: $id) {
    ...allFeedSubscriptionsFields
    feed {
      posts(last: 5) @connection(key: "posts") {
        nodes {
          id
          url
          title
          htmlContent
          publishedAt
        }
      }
    }
  }
}
